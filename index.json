[{"categories":null,"content":"最近在读《原生家庭：如何修补自己的性格缺陷》，其中书友对一句话的想法引发了我的回忆： 父母在我们心里种下了精神和情感的种子，它们会随我们一同成长。在有些家庭里，父母种下的是爱、尊重和独立，而在另一些家庭里，则是恐惧、责任或负罪感。——《原生家庭：如何修补自己的性格缺陷》 直到我谈了恋爱，我才意识到原来不是所有的父母都会和孩子坐下来好好沟通、做错了道歉以及与孩子共同成长进步。这一刻，我无比庆幸生在我的家庭里。父母以及弟弟带给我的这种爱，让我会勇敢、大胆、明确的表达爱意和对方让我舒服不舒服的点，不必委曲求全，使我清楚的知道有效沟通、清楚的表达是很重要的一件事。以前的我从来没有想到“自信、落落大方、家教好、有教养”诸如此类的词会集中体现在我的身上，当它们出现的时候，我才恍然大悟，原来我的成长里藏了这么多父母对我的爱啊即使在我成长的过程中，我们的相处有过许多的摩擦，但现在看来，那并不影响他们爱我，只不过是一开始不懂如何爱、如何表达爱。——一只鸭鸭 我和我的妹妹是由爷爷奶奶带大的，近年来我已经毕业了，母亲也就回家带我妹妹，届时妹妹已经上高中了，一个人的心性既已成熟，是一个寻求认同感的年龄。母亲在县城公安局帮忙炒菜，早晚接送下妹妹，但她们相处的其中爆发了很多争吵与怨恨，说来也在意料之中。 的确就是如同书友的想法所描述的那样，并不是所有的父母都会和孩子坐下来好好沟通，并且做错了事并不会承认错误，是那种很坚决的那种，就算大家都心知肚明，而去宁愿引发更大的矛盾或者争吵，当然这可能只是具有某种特定背景下的行为，如果全盘否定是过于不公平。 因为当初我是目睹的，一直以来都很不理解，后来追问其缘由。答道：“如果我承认了错误，那她岂不是更加不听话”，其中的她当然指的是我妹妹，不听话也不是字面笼统的意思，而是缺乏一个对象，更加不听她的话。顿时就觉得十分可笑，这个答案已经出乎我的意料，传统以来以父母不会错的观念是真的有毒。当我明确表述她这种想法是错误的，得到的回应也让我不知所措。“你还不懂，你以后当父母了就会懂的”，很有把握地轻轻说道。 ","date":"2022-07-09","objectID":"/%E8%B0%88%E8%B0%88%E5%8E%9F%E7%94%9F%E5%AE%B6%E5%BA%AD/:0:0","tags":["碎碎念","情感"],"title":"谈谈原生家庭","uri":"/%E8%B0%88%E8%B0%88%E5%8E%9F%E7%94%9F%E5%AE%B6%E5%BA%AD/"},{"categories":["生活周刊"],"content":" 享受生活，热爱生活，发现生活中的美 ","date":"2022-07-09","objectID":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/:0:0","tags":["思考","生活"],"title":"生活周刊 000 开端","uri":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/"},{"categories":["生活周刊"],"content":"缘起 数月前开始寻找中文互联网的一些优质的内容，至于契机是什么，也想不起来了，不过也无妨，总之接触到了RSS、newsletter的概念，也让我对blog的定义有了新的认识，因为我的职业是程序员，也经常看一些技术博客，所以在印象中blog=技术博客，没想到一些人会建立私站，作为个人的一份自留地，分享着自己的想法、思考、总结，是这信息爆炸的时代的一份净土。 ","date":"2022-07-09","objectID":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/:1:0","tags":["思考","生活"],"title":"生活周刊 000 开端","uri":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/"},{"categories":["生活周刊"],"content":"偏好 近几个月来订阅了不少优质内容，相对于咨询来说，我比较喜欢看有价值的文章，所谓有价值的文章并不只是说知识的分享，也可以是作者的一些想法与思考，可以让我相对于昨天的自己有所收获。 例如我关注的一个推特ID为happy xiao的一份名为《可乐周报》的newsletter，其每份周报的前言如下： 我是 happy xiao，欢迎你订阅可乐周报，我在这里分享过去一周里值得推荐的想法。我不关注新闻，不关注科技，不关注政治，不关注知识。 我只关注让你我成长的想法。 这句话就恰恰击中了内心，可谓可遇不可求。 ","date":"2022-07-09","objectID":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/:2:0","tags":["思考","生活"],"title":"生活周刊 000 开端","uri":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/"},{"categories":["生活周刊"],"content":"破茧 过程中渐渐摆脱了所谓的信息茧房，无非做了如下几点： 关闭各种软件的个性推荐；如b站、淘宝、豆瓣、抖音等 每日坚持使用微信读书阅读；其实阅读的时长不重要，重要的是阅读习惯 订阅优质的内容；blog、newsletter、周报、日报等，我目前使用的是iOS平台的RSS客户端Redder ","date":"2022-07-09","objectID":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/:3:0","tags":["思考","生活"],"title":"生活周刊 000 开端","uri":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/"},{"categories":["生活周刊"],"content":"抖音 因为个人是比较排斥抖音的，但由于工作缘故会装上友商的App，关闭个推的前后对比是很明显的。 关闭前：对于使用次数少、用户标签不明显的用户，会推荐一些大众喜好的内容，还是会令人想继续看下去的，以此慢慢给用户打标签。 关闭后：推荐的内容很少有我想看下去的，甚至不乏一些制作粗糙的内容。 ","date":"2022-07-09","objectID":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/:3:1","tags":["思考","生活"],"title":"生活周刊 000 开端","uri":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/"},{"categories":["生活周刊"],"content":"b站 b站是经常使用的一个平台，其上不乏很多优质的视频。虽然说我很少从推荐流中点开视频或者挖掘宝藏up主，但之前一直推荐一些同质化的内容，也是有些许视觉疲劳。自从关闭以后，内容的品类丰富很多，有时候还真能发现一些不错的视频。 ","date":"2022-07-09","objectID":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/:3:2","tags":["思考","生活"],"title":"生活周刊 000 开端","uri":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/"},{"categories":["生活周刊"],"content":"开端 至于为什么我要开始撰写生活周刊呢？ 希望能够静下心来思考，能够发现生活中的美好，并努力用优美的笔触将其记录下来。 在阅读的过程中，想收藏一些优质的内容，其中萌发的一些想法与思考，需要个总结记录的地方以及能够简单分享他人的方式。 暂时没有达到很厉害的水平，能够输出很好的观点与思考，因此立足于个人生活及其迸发出来的想法。 ","date":"2022-07-09","objectID":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/:4:0","tags":["思考","生活"],"title":"生活周刊 000 开端","uri":"/%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A-000-%E5%BC%80%E7%AB%AF/"},{"categories":["技术"],"content":"简介 MVI 与 MVVM 比较相似，其借鉴了前端框架的思想，着重强调数据的单向流动和唯一数据源 ","date":"2022-06-01","objectID":"/mvi/:1:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"优势 强调数据单向流动，很容易对状态变化进行跟踪和回溯 使用ViewState对State集中管理，只需要订阅一个 ViewState 便可获取页面的所有状态，相对 MVVM 减少了不少模板代码 View通过ViewAction与ViewModel进行通信，又通过StateAction以触发State的变化 ","date":"2022-06-01","objectID":"/mvi/:2:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"问题 当页面复杂，State容易膨胀 ","date":"2022-06-01","objectID":"/mvi/:3:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"最佳实践 ","date":"2022-06-01","objectID":"/mvi/:4:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"以页面为维度定义State，并且注意State中数据的定义，切勿数据裸在State里面 例如一个按钮的状态可能对应State中的数个字段，可进行包裹为ButtonState放置在State。 当State复杂起来 ","date":"2022-06-01","objectID":"/mvi/:4:1","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"案例 ","date":"2022-06-01","objectID":"/mvi/:5:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"收藏逻辑 我要收藏一个视频，UI发送一个事件到ViewModel，ViewModel调用Repository触发我们的收藏请求。 收藏请求回来需要展示一个Toast，提示用户收藏成功或者失败，这就以为着我们的ViewModel处理请求结果后，触发State变化，也就是我们CollectButtonSetate的变化。除此之外，还要想办法通知UI显示一条Toast。 如果存储一个字段用于标识UI需要显示的Toast，UI collect到该状态时候会显示该Toast，但如果切后台再返回，UI又会显示该Toast了，因为我们的State是StateFlow承载的， ","date":"2022-06-01","objectID":"/mvi/:5:1","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"新手引导 用户打开一个页面，需要一次显示2个引导浮窗。 如果是在MVI的架构下，做这个逻辑；判断是否显示新手引导的逻辑得再逻辑层，即ViewModel层； ","date":"2022-06-01","objectID":"/mvi/:5:2","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"使用误区 如图，初次使用MVI的同学在该页面的State中定义了2个字段来描述引导浮窗的状态 其中存在两个问题： 使用2个字段来描述是丑陋的 使用可空类型来描述引导流程中的状态更是丑陋的 最佳实践：定义一个枚举类描述引导流程中的状态 enum class GuideState{ NOTHING, SHOW_TITLE_GUIDE, SHOW_DIRECT_ITEM_GUIDE } 其次，再看看UI层的逻辑 其实这个逻辑也是挺奇怪的，监听Title变化的地方，存在引导显示的逻辑；这就违背了我们的原则，View只需监听相对应的状态变化即可。 其次，再看看这个ViewAction的具体执行逻辑，如图，通过判断是否需要显示来更新引导的状态。 所以第二个疑惑的点就是，引导的状态其实并不依赖于其他的UI上面的东西，和用户的操作无关，正如与用户的操作无关却发送一个ViewAction是不太合适的，其实只需要在列表数据加载成功后，通过接口查询当前是否展示引导 去更新引导的状态即可。 OK，我们总结下如何在MVI架构添加业务逻辑： 定义一个状态来描述这个元素 在UI层监听这个状态的变化做相应的逻辑 在合适的时机更改这个状态 ","date":"2022-06-01","objectID":"/mvi/:6:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"规范 ViewAction定义：用户在UI层的输入，例如：点击、下拉刷新、上拉加载更多，ClickTitle、LoadMore、Refresh StateAction定义：触发状态改变的操作，例如：修改按钮状态的可见性，则可定义为 UpdateXXBtnVisibility State定义：以页面为单位描述该页面的UI状态 Store定义：以页面为单位存储当前页面的UI状态 用户的输入事件向下流动，UI状态向上流动 如果要dispatch一个Action，不要一个行为派发多个Action，一个行为对应一个Action；例如：如果我们定义了两个Action，依次dispatch，以完成一个操作；倘若后面某个Action的能力改变了，是否会影响到另外一个Action呢？ ","date":"2022-06-01","objectID":"/mvi/:7:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"待解决问题 ","date":"2022-06-01","objectID":"/mvi/:8:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"页面初始化逻辑 目前页面数据的加载的触发由名为LoadTypeFlow的流驱动，而目前在UI层主动向ViewModel dispatch一个ViewAction以触发LoadTypeFlow的改变以触发页面数据拉取 其实这种流向是不符合我们的规范的，用户只是打开了该页面并没有输入一个事件，实际上应该是可以做成在ViewModel初始化的时候去触发数据加载的。 ","date":"2022-06-01","objectID":"/mvi/:8:1","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["技术"],"content":"参考 Android官方-应用架构指南 Android官方-界面事件 ","date":"2022-06-01","objectID":"/mvi/:9:0","tags":["kotlin","mvi"],"title":"mvi","uri":"/mvi/"},{"categories":["生活"],"content":"摩的 双月湾的出行很是不便，滴滴是无人接单的，于是晚上出去觅食只能暂且步行而去。 天下着小雨，路上瞅见小巷里的几辆电动单车，心中不免一般欢喜，可以少走两步了。记得上一次骑电单车还是毕业那会，去衡阳看女朋友那会了，骑着一辆单人电单车，从工学院门口一路骑到市区的商圈，也不失一番乐趣。 扫码后才发现起步价贵得惊人，十元起步，已经快赶上打车了，况且路程也不过2公里，实属不划算，只能作罢，继续往前走去。 不久一辆摩的从身旁经过，正纠结走路还是摩的，差不多走来三分之一的路程了，咬咬牙还是继续往前走吧！不过走了一会又开始后悔没叫下那辆摩的了，终究还是想坐摩的的，其一是饿得不行了，已过饭点2小时了；其二是这淅淅沥沥的雨，似乎很难停下，容易让人感到这路程的漫长。 一番纠结过后，还是决定叫下一辆摩的，起初一辆摩的叫价属实颇高，2公里的路居然还要20元，也不愿意被回价，我们只能望着他的背影扬长而去。 ","date":"2022-05-03","objectID":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/:1:0","tags":["旅行","海边"],"title":"双月湾游记","uri":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/"},{"categories":["生活"],"content":"1+1糖水铺 等待女朋友化妆的间隙，上小红书翻翻看周边有什么好吃的，看到一帖子推荐一个吃糖水的地方，想来在深圳呆的两年多里也没找到一家地道的糖水铺，难道在这小小的惠东县能有，也是抱着一试的心态奔过去了。 天落着小雨，打了个摩的，到了当地的菜市场，顺着地图正在街上寻着，打开手机看了看地图，地图分明显示就在身前，但却没见着所谓的店面，正疑惑时，女朋友一声，”诶，这不就是嘛！“。侧身一看，推车旁挂着的招牌上面分明写着几个大字“1+1老字号糖水”，原来没有门面啊，只是街边的一个摊位，带着两辆小推车。但思来想去，却又拥有门面固定的性质，因为地图上还标注了它呀！ 难怪在对面摊位买柠檬鸡爪时，还惊讶这个摊位为啥这么多人买，到底是卖啥的。 看过招牌上的菜单，选了个莲子元肉，其实一时我也没想起来这是个啥，但后来又正中下怀。果然，缘，妙不可言。 莲子元肉糖水，第一口就让我想再买一碗，第一口就让我回味到了几年前的那碗糖水，清甜微凉，我想糖水本应如此，在这淅淅沥沥的雨天，吃一口糖水也挺合适。 一碗喝完，想想还是别再买了，令人欢喜的可并不只是那清甜，而是那许久尚未品尝的味道，生怕再吃一碗日后就没有这份回忆了。 ","date":"2022-05-03","objectID":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/:2:0","tags":["旅行","海边"],"title":"双月湾游记","uri":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/"},{"categories":["生活"],"content":"路边老人 记得小时候，还住在农村，看到载客中巴在远处的山路经过，听到一阵喇叭声，满心欢喜地跟着嘟——嘟——嘟。 看到路边老人，搬个小凳，坐在自家门口，淡然地看着人来车往，或许这一坐就是半天。 一个正欣喜入世，一个已悄然出世。 ","date":"2022-05-03","objectID":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/:3:0","tags":["旅行","海边"],"title":"双月湾游记","uri":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/"},{"categories":["生活"],"content":"菜市场的果贩 喝完一碗糖水，吃下一碗潮汕汤粉后，已然十点，自当满意离去。 沿着小街往回走，路边的店铺基本打烊了，走过一家水果铺，摊位前的数个果盆中还分别泡着几块菠萝、奈李、芒果、桃子，至于为什么是泡在水里的，还心存疑惑，可以理解菠萝是可以泡在盐水里的，其他的就不应该呀，驻足一会，老板就开口，顺手递过来了一个塑料袋。 刚饱餐一顿，本不想再吃其他东西，但是女友却欣喜接过，兴致勃勃地指着菠萝、桃子，说道要三块菠萝，两块桃子，我只好无奈看看同行的朋友，相视一笑，便随她吧。 女友回头问了问我们要不要吃，我们只能笑着说吃不下了，你就自个买点吃吧。老板用铲子从果盆中帮挑出水果，本就为数不多的菠萝，被挑走了几个，还剩下一个，但看到老板还继续把铲子向最后一块菠萝伸去，我们连忙罢手说吃不了那么多啦，可老板的手丝毫没有停下，直到最后一块菠萝入袋。后续其他水果也多舀了点，当女朋友还在想要点啥的时候，还自顾地帮舀了几个剩下的李子入袋。 虽然一直在说着不要，可我们并没有一丝恼怒，我在一旁静静观赏着这路灯下极具人间烟火气的情景，觉得颇有意思。老板也只是想把零星的几块水果都卖出吧，很可能这是他今天最后的顾客了吧。虽说我内心再觉得如何有意思，可我怎么也描写不出来那有意思的场景，受限于文笔，受限于不那么细致入微的观察，挺可惜的。 ","date":"2022-05-03","objectID":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/:4:0","tags":["旅行","海边"],"title":"双月湾游记","uri":"/%E5%8F%8C%E6%9C%88%E6%B9%BE%E6%B8%B8%E8%AE%B0/"},{"categories":["随笔"],"content":"打开了腾讯电子签，点击小借款，输入借出数额：100000，填上借出归还时间：2022.1.28-2022.2.28，为期一个月，利率0%，点击发送给借款人微信：姑爷，过程毫不拖沓，淡定地借出了人生中第一笔不菲的款； 接近大年三十的一个下午，我在楼下玩着Switch，奶奶过来说让我借一笔钱给姑爷周转给发工人工资，现在又借不到别人的钱，当说出借款十万的时候，我也并没有惊讶，只是说我再考虑下。晚上在房间里的时候，姑爷也来到了我的房间，当然也是说要借钱这一回事，其中也提到我姑姑不好意思来开这个口，后续我只也是例行问几个问题，老板怎么不发工资过来呢，什么时候发之类的，是肯定会发的吧，毫无顾虑地就答应了。他们本要写一个借条，我想起腾讯有个电子签的小程序，是具有法律效应的，因此就有来文章开头的那一幕。 十万元对我来说，虽然不是老本钱，但也算是幸苦钱，想到之前读大学的时候姑姑给我准备的上学的电脑、手机，也算是还个人情吧。后来从姑姑口中才得知，当时她也没钱，但是因为允诺了，是向别人借钱，听后心里觉得一酸。 一天晚上，时间也快到12点了，脑海中突然回想起前天借钱的种种，思绪不禁往最坏的情况蔓延过去，一时间各种焦虑涌上心头，此时的脑袋是多么清醒啊。遇到了之前从来遇到过的事情，没想到自己给上的答卷还挺敷衍。 辗转反侧，彻夜难眠，抬起手腕看看时间，已经是凌晨一点半，睡意毫无，望着漆黑的夜，一股无助感悄然降临。 拿起手机，给女朋友打了几个微信电话，当然是无人接听，我也只是想寻求一个简单的心里慰藉。在这漆黑的夜里，大家早已沉睡，甚至脑海中还臆想着下楼，走进奶奶的房间里，问问姑爷什么时候会还钱给我？ 在茫然无助之中也只能自我慰藉几句，直至焦虑褪去，睡意袭来，陷入黑夜之中。 ","date":"2022-03-03","objectID":"/%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8D%E8%8F%B2%E7%9A%84%E5%80%9F%E6%AC%BE/:0:0","tags":["成长","碎碎念","情感"],"title":"第一次不菲的借款","uri":"/%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8D%E8%8F%B2%E7%9A%84%E5%80%9F%E6%AC%BE/"},{"categories":["技术"],"content":"kotlin Android-Redux-Intro ","date":"2021-05-29","objectID":"/%E4%B8%8D%E9%94%99%E7%9A%84%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/:0:0","tags":["kotlin"],"title":"不错的技术文章","uri":"/%E4%B8%8D%E9%94%99%E7%9A%84%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"},{"categories":["技术"],"content":"协程 Coroutines : First things first 如何优雅的取消协程 ？ Kotlin Coroutines(协程) 完全解析（三），封装异步回调、协程间关系及协程的取消 [译] 如何优雅的处理协程的异常？ ","date":"2021-05-29","objectID":"/%E4%B8%8D%E9%94%99%E7%9A%84%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/:1:0","tags":["kotlin"],"title":"不错的技术文章","uri":"/%E4%B8%8D%E9%94%99%E7%9A%84%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"},{"categories":["技术"],"content":"gradle.properties中定义变量 light_sdk_version = 2.2.5.14 ","date":"2021-04-29","objectID":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/:0:0","tags":["gradle"],"title":"gradle.properties中定义变量","uri":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/"},{"categories":["技术"],"content":"build.gradle中使用 现在gradle中定义一个函数 def getProperty(String filename, String propName) { def propsFile = rootProject.file(filename) if (propsFile.exists()) { def props = new Properties() props.load(new FileInputStream(propsFile)) if (props[propName] != null) { return props[propName] } else { print(\"No such property \" + propName + \" in file \" + filename) } } else { print(filename + \" does not exist!\") } } 使用 lightsdk : \"com.tencent.light-withoutso:lightsdk:${getProperty(\"gradle.properties\", \"light_sdk_version\")}\" ","date":"2021-04-29","objectID":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/:1:0","tags":["gradle"],"title":"gradle.properties中定义变量","uri":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/"},{"categories":["技术"],"content":"代码中使用 在build.gradle中定义 defaultConfig { buildConfigField \"String\", \"LIGHT_SDK_VERSION\", \"${light_sdk_version}\" } 使用 BuildConfig.LIGHT_SDK_VERSION build.gradle中定义变量 ext { light_sdk_version = \"2.2.5.14\" light_sdk_component_level = \"78\" pag_sdk_version = \"3.3.0.138\" pag_sdk_tag_level=\"3\" } ","date":"2021-04-29","objectID":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/:2:0","tags":["gradle"],"title":"gradle.properties中定义变量","uri":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/"},{"categories":["技术"],"content":"build.gradle中使用 defaultConfig { buildConfigField \"String\", \"LIGHT_SDK_VERSION\", \"\\\"${project.light_sdk_version}\\\"\" } ","date":"2021-04-29","objectID":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/:3:0","tags":["gradle"],"title":"gradle.properties中定义变量","uri":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/"},{"categories":["技术"],"content":"代码中使用 在build.gradle中定义 defaultConfig { buildConfigField \"String\", \"LIGHT_SDK_VERSION\", \"\\\"${project.light_sdk_version}\\\"\" } 使用 BuildConfig.LIGHT_SDK_VERSION ","date":"2021-04-29","objectID":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/:4:0","tags":["gradle"],"title":"gradle.properties中定义变量","uri":"/gradle.properties%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/"},{"categories":["生活"],"content":"零食 ","date":"2020-07-16","objectID":"/%E4%B8%80%E4%BA%9B%E9%9B%B6%E9%A3%9F%E6%8E%A8%E8%8D%90/:0:0","tags":["零食"],"title":"一些零食推荐","uri":"/%E4%B8%80%E4%BA%9B%E9%9B%B6%E9%A3%9F%E6%8E%A8%E8%8D%90/"},{"categories":["生活"],"content":"百草味 商品名 推荐指数 满300-200 价格 菠萝干 100g ★★★★ 25.50 ￥8.73 泡椒凤爪 160g ★★★★★ 26.90 ￥9.21 脆冬枣 35g ★★★ 10.90 ￥3.73 椰丝球 210g ★★★ 32.50 ￥11.13 夏威夷果 100g ★★★★ 29.50 ￥10.11 猪肉脯（白芝麻味） 100g ★★★★ 29.50 ￥10.11 手撕鱿鱼条 80g ★★★★ 32.50 ￥11.13 一字豆干（五香味） 200g ★★★ 25.90 ￥8.87 卤鹌鹑蛋（五香味） 135g ★★★★ 26.90 ￥9.21 牛肉条 50g ★★★★ 32.50 ￥11.13 碧根果仁 56g ★★★★★ 31.50 ￥10.78 麻辣植物牛肉 100g ★★★★★ 25.90 ￥8.60 满300减200 买了12包共104.10元，谁知过不到几天，就有满300减210的活动了（这个应该是最划算的了） ","date":"2020-07-16","objectID":"/%E4%B8%80%E4%BA%9B%E9%9B%B6%E9%A3%9F%E6%8E%A8%E8%8D%90/:1:0","tags":["零食"],"title":"一些零食推荐","uri":"/%E4%B8%80%E4%BA%9B%E9%9B%B6%E9%A3%9F%E6%8E%A8%E8%8D%90/"},{"categories":["生活"],"content":"源于最近需要换眼镜，因此做了下功课。 防蓝光非球面镜片 其实现在镜片都会带有防蓝光的属性，但是这个会更好一些，不过会造成镜片偏黄，透光度下降。生活中有害蓝光大都来自于电屏幕，可能用眼久了，多起来走走看看远方效果会更好一点，所以不考虑这种镜片。 折射率 阿贝数 价格 1.70 71L 37 688送镜架（淘宝） 1.67 67L 32 455送镜架（淘宝） 1.60 60L Pro 40 不考虑 1.60 60L 33 不考虑 PMC非球面镜片 PMC是一个新的材料，这种镜片透光度是98%相对于普通镜片（93%~95%）好一些，戴起来效果会更好一点，相对来说价格也更贵。 折射率 阿贝数 价格 1.70 71L 37 751送镜架（淘宝） 1.60 60KP 40 378送镜架（淘宝） 1.71非球面镜片 对于500°以上的近视患者，相对来说会选择折射率高的镜片，折射率越高镜片可以做得越薄，但是不能一味追求轻薄，因为镜片有一个阿贝尔指数，这个指数和折射率成反比，阿贝尔数越高镜片成像越清晰。 型号 阿贝数 价格 71L 37 KR树脂、蓝光防护膜 688送镜架（淘宝） 71KP 37 PMC超亮、天视A6膜 751送镜架（淘宝） 71AS 37 KR树脂、明视复合膜 598送镜架（淘宝） 明视复合膜又称绿膜，天视A6膜又称蓝膜，蓝膜相对绿膜防油污容易清洁 ","date":"2020-05-16","objectID":"/%E6%98%8E%E6%9C%88%E7%9C%BC%E9%95%9C%E5%AF%B9%E6%AF%94/:0:0","tags":["眼镜"],"title":"明月眼镜对比","uri":"/%E6%98%8E%E6%9C%88%E7%9C%BC%E9%95%9C%E5%AF%B9%E6%AF%94/"},{"categories":["生活"],"content":"18年末 年后便是大三，驾照也已到手，也没其余杂事。那可要准备面试，年后就得找暑期实习了。虽说离毕业还有两年，但学校里的课程是不能再学到可用的知识了，更应该投入到实际项目的开发中去，能对专业能力有很大的改进和提升，同时也是一段可贵的实习经验，加速自己各方面的成长。如果实习表现优秀，能得到leader的认可，通过转正拿到毕业生offer，后面一学年也就没什么压力可言，不过找到一份好的实习还是具有挑战性的。 一同学年前就拿到了字节跳动的offer，可以说是非常优秀。能够领先这么多，想想看，他每天坚持学习，当然水到渠成，不足为奇。我与他的关系也仅限于点头之交，不好询问面试的诸多问题。当然字节跳动的offer对我的吸引力不亚于bat，极其羡慕。 想买的技术书籍有好几本并且价格不菲（60+），倒不如买个Ipad看PDF版，也易于携带去上课。价格（2300）相对于穷学生来说还是比较昂贵，也不想让妈妈给我付账，想着过年的红包钱可以预支，再三纠结后还是分期买下了，当然Apple Pencil是还让妈妈付的，用于学习，也心安理得。 善于投资自己，对自己有好处的东西，尽管去做吧，切勿因小失大 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:1:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"复习 实验室Android部门上一任部长在字节跳动工作，年末实习离职了，可内推几位同学的简历（免笔试），由于当时的我还刚开始复习，并没有太大的把握去面试，但还是认真地制作了简历。但由于年前错过了内推的时间，因此也错失了这次机会，当时的自己依旧没有把握去应对这场面试，也就不了了之 。 了解到另外一位同学也让学长内推了简历，但是一面直接没过，问的问题当中我自己也不能保证初次面试下有条理的说出来。 当时也进入了复习的状态，日常翘课，上课也只带自己的Ipad去复习，日常刷牛客看面经，复习的日子就是这样有条不紊的进行着。 刷牛客网的Java基础题+剑指offer+八大排序 看牛客网面经 Android基础 Android开发者艺术探索 Android常用框架源码解析 复习不是学习，是需要知识储备的，知识储备又源于长期坚持学习 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:2:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"面试 开始也投了些中小公司，对于BAT这种大企业依旧没有十足的把握。 随着准备得越来越充足，其中也面试了大大小小几家公司，当然充满遗憾和心酸，然而面试经验也越发丰富，到最后面试腾讯的时候也是十分顺利哈。 凡事需要准备，准备越充足也会越自信，自然手到擒来 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:3:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"CVTE 一面 第一次面试是CVTE的电话面，问的问题都比较常规，其中两个问题不会，不过也通过了。 hr面 当时也比较开心，本以为可以首战告捷，也没有想到还有后来这么一些事情。当时在网上看了些这个公司的一些帖子，知乎上面大部分都是黑这家公司的，同时牛客网上面也了解到这家公司的hr面很多人被刷。不过的确也实际体验到了，也不足为奇。 询问未来规划、理想、家长里短，性格缺陷等一系列私人问题，其实让你卸下心防，其次再问对薪资的要求、对加班的看法、工作地的想法。还是太年轻，不愿当舔狗，对薪资要求稍高又不想加班。事后想想，其实可以先拿到offer再说，没必要这么真实。 见人说人话，见鬼说鬼话 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:3:1","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"蘑菇街 一面 项目组内的一个小哥，面试很顺利，对我的印象很好，实在地夸赞了我一番。 二面 组内的leader，项目难点和自定义View（如何实现一个列表下拉刷新控件）答得不好，就算其他问题回答得不错并且算法也秒了，但是还是很遗憾的得被刷了。其实也觉得项目难点不好回答，如今想想当时的回答的确很差劲，后面让自己实现自定义控件也慌了，应该好好思考，或许还能够得到提示，而不是直接说不知道。 面试结束后的几天内，每隔几十分钟刷新一次蘑菇街招聘页面，最终还是收到了感谢信。记得当时连去了蘑菇街要做什么都想好了，终究情非得已。 事情没有尘埃落定之前都不能掉以轻心 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:3:2","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"网易 一个老大哥和一个小老哥一起视频面试的我，无语了都。 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:3:3","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"拼多多 在图书馆的走廊座椅上被一位全栈大佬用微信视频面了两个小时，被问到怀疑人生也毫不为过，处境甚是窘迫，看到了自己很多不足，对于自身这种不服输、自尊心强的性格，难免会被问得面红耳赤。 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:3:4","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"腾讯 牛客网面经 面试官是湖南老乡（后来才知道是我的leader），面试过程很亲和，面试也就很自信，受到了面试官的青睐。 厚积薄发 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:3:5","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"初来乍到 安排好学校的代课事宜就立马逃脱了学校，和同学一起组队来到了深圳。 入住了公司为实习生安排的中转酒店，同住的是一名研究生。 第二天便去公司报道，领取了工卡、公仔，去了自己的工位，不过没有见到leader。 由于酒店住宿洗衣服不方便，而且和陌生人同住，感觉不是那么愉快，便下午就去看房子。 下午再过来的时候，遇见了我的leader和我的导师，在导师的帮助下安装好了iMac，初次见面当然是比较拘谨。 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:4:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"租房 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:5:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"留用答辩 当然实习的时候也无不想过留用答辩的事情，毕竟如果能够顺利留用，对之后毕业的压力会减轻很多，不用再复习去秋招，不用担心毕业的事情等等，安心学习、好好生活就可以了。 当然，更重要的是自己也愿意留下来。在我自己看来，短视频是未来生活的一部分，这点是毋容置疑的，短视频目前似乎在很多人的生活中代替了以往的媒体，成为了获取信息的重要来源之一。 记得和我一起实习的女同学对我说过这样的一句话：你真的好稳啊，看起来做什么事都那么从容。可能是之前找实习的时候一起聊过天，那时候她已经拿到了Tencent的offer，而我一无所有，但是我的脸上也还能挂着一副笑容，从容不迫地和他们聊着，再结合如今我的工作态度以及对留用的看法才得出这样的一种结论。而我回了她一句范仲淹的《岳阳楼记》中的一句话：不以物喜，不以己悲。 其实，担忧未来本是一件好事，但不需要过分担忧，更重要的是能够做好当前的事。目前实习的工作做好了，个人能力得到了领导的认可，工作成果得到领导的赞赏，这些事不正是作为留用的一个考核点。很多时候，当前的所作所为往往成就着将来，当然前提是目标明确 同组还有一个华中科技大学的研究生，本科就读于厦门大学，可以说在学历背景上面已经甩我几条街了，同时年龄也比我大三岁，但是这也不能足以将我battel下去，终究还是得看个人能力。 记得一起接受一个模块重构的需求，自己在团队协作以及解决问题的能力就很完美的体现出来，以致于导师都愿意和我交流，我们两个人当中把我当做这个需求的负责人。而又为什么使得别人信服我呢？总结了一下几点（Ta指代同组那位研究生）： 谦虚好问，善于沟通，及时同步开发进度以及遇见的困难并请教相应的同事；多次请教导师、同事问题，并一起讨论解决方案。相对来说，Ta就比较沉闷，很少去找导师或同事。 解决问题能力强；能够比较高效完成自己负责模块以及解决遇见的问题。相对来说，Ta开发效率比较低，甚至有些常见的问题都不知道如何解决。 团队意识；完成自己分配的需求后，又去关注其他人负责的模块，帮助同事解决问题（此条在个人能力强的基础上进行）。相对来说，Ta自己的模块的需求都不能高效完成，那就何谈帮助别人。 以至于答辩完成以后，leader也和我说了为什么留下了我：学历不代表学力，他在学历背景方面可以说甩你几条街，但是在学习能力方面你很厉害 答辩不久后，同组实习生离职去准备秋招了，而我仍呆在鹅厂实习。期间也给我换了一个导师——一个大我4岁的老哥，后面也成为了我关系最好的同事，亦师亦友，给予了我很多帮助，总而言之还是很幸运的。 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:6:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"尚未入职，leader跑了 后面部门进行组织架构调整，当前微视的业务换了一波人来接手，原leader带一批人去做底层能力的业务，当时leader也有找各位同事一一聊过去，可以说大部分人都想过去吧。可唯独没有找我聊，也许我只是一个实习生，并不能对他产生很大的价值，而名额又是有限的，那就很好理解了。还没正式入职就换leader了，感觉还是很不好的，毕竟换了一个新的leader，又得重新建立信任，展示自己的能力。 记得，新来的leader有一一找我们谈话，那是一个战战兢兢，说话都很是拘谨，说话结结巴巴的，时而哆嗦，现在想来真是可笑呵！ 后面也就那样，组织架构的变化，对我也并未产生多大的影响，只是默默地搬砖，做好自己的工作，兢兢业业干到年底。那时疫情并不起眼，正慢慢袭来，临走前去企鹅医生买了两袋口罩以备路上之需。 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:7:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["生活"],"content":"疫情之年，不串门的春节 回家以后，疫情迅速发展起来，爆发地——武汉市已做封城处理，城内有的人想出来，城外有的人想进去，境地不同，心志不同。远处十八线小县城，周围没有感染的病例，但每天看看全国感染新增人数也闹得人心惶惶，不敢出门，整个春节基本都在家里度过。就算想出门，也没有口罩可用，市面上的口罩早已销售一空，家里人的一个口罩也是用好久，以维持正常生活所需。 ","date":"2020-02-03","objectID":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/:8:0","tags":["总结","心得","面试","学生时代"],"title":"2019年总结","uri":"/2019%E5%B9%B4%E6%80%BB%E7%BB%93/"},{"categories":["技术"],"content":"视频加滤镜播放 MediaCodec解码——\u003eOpenGL es——\u003e GLSurfaceView ","date":"2019-08-04","objectID":"/opengl-es%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E5%90%8E%E5%AF%BC%E5%87%BA/:1:0","tags":["OpenGL ES"],"title":"OpenGL ES：视频加滤镜后导出","uri":"/opengl-es%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E5%90%8E%E5%AF%BC%E5%87%BA/"},{"categories":["技术"],"content":"视频滤镜合成导出 MediaCodec解码——\u003eOpenGL es——\u003e MediaCodec编码 大体来说就是OpenGL渲染后的输出不一样，需要使用编码器编码保存到本地，由于OpenGL ES并不负责窗口管理以及上下文管理，该职责由各个平台自行完成，没有了GLSurfaceView为我们创建的上下文环境，因此我们需要使用相关的API初始化OpenGL的上下文环境以支持后续的操作。 主要流程还是上图所示，该功能的实现，需要对整体的流程有一定的了解同时也需要掌握MediaCodec的使用以及需要注意一些坑，否则可能会导致视频无法播放。 ","date":"2019-08-04","objectID":"/opengl-es%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E5%90%8E%E5%AF%BC%E5%87%BA/:2:0","tags":["OpenGL ES"],"title":"OpenGL ES：视频加滤镜后导出","uri":"/opengl-es%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E5%90%8E%E5%AF%BC%E5%87%BA/"},{"categories":["技术"],"content":"注意 MediaMuxer写完数据需要手动停止并释放资源，否则写的视频文件没有文件尾会导致不能播放。同理解码器和编码器在用完以后也需要释放。 一个线程对应一个OpenGL es 上下文，因此我们需要初始化俩个上下文环境，一个用于OpenGL着色器、顶点数据等渲染配置的初始化，一个用于在编解码线程中渲染。编解码线程中的上下文需要设置与OpenGL的初始化的线程共享上下文资源，包括纹理、FrameBuffer以及其他的Buffer等资源。 渲染一次完成后，需要切换一次egl的frame buffer，EGL的工作模式是双缓存模式，内部拥有俩个frame buffer（fb），当EGL将一个fb渲染到屏幕上的时候，另一个就在后台等待OpenGL进行交换。 EGL14.eglSwapBuffers(mEglDisplay, mEglSurfaceEncoder); ","date":"2019-08-04","objectID":"/opengl-es%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E5%90%8E%E5%AF%BC%E5%87%BA/:3:0","tags":["OpenGL ES"],"title":"OpenGL ES：视频加滤镜后导出","uri":"/opengl-es%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E5%90%8E%E5%AF%BC%E5%87%BA/"},{"categories":["技术"],"content":"注意点 MediaCodec 解码后的原始数据，格式为yuv，而OpenGL所能渲染的格式为rgb，因此我们需要使用扩展库中的扩展纹理 GLES11Ext.GL_TEXTURE_EXTERNAL_OES 而它的作用就是实现YUV格式到RGB的自动转化。 片段着色器中需使用扩展采样器： uniform samplerExternalOES sTexture COLOR_FormatYUV420Flexible YUV420Flexible并不是一种确定的YUV420格式，而是包含COLOR_FormatYUV411Planar, COLOR_FormatYUV411PackedPlanar, COLOR_FormatYUV420Planar, COLOR_FormatYUV420PackedPlanar, COLOR_FormatYUV420SemiPlanar和COLOR_FormatYUV420PackedSemiPlanar。在API 21引入YUV420Flexible的同时，它所包含的这些格式都deprecated掉了。 那么为什么所有的解码器都支持YUV420Flexible呢？官方没有说明这点，但我猜测，只要解码器支持YUV420Flexible中的任意一种格式，就会被认为支持YUV420Flexible格式。也就是说，几乎所有的解码器都支持YUV420Flexible代表的格式中的一种或几种。 此处引用： https://www.polarxiong.com/archives/Android-MediaCodec视频文件硬件解码-高效率得到YUV格式帧-快速保存JPEG图片-不使用OpenGL.html ","date":"2019-07-11","objectID":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/:1:0","tags":["OpenGL ES"],"title":"OpenGL ES：配合MediaCodec硬解码渲染（视频加滤镜播放）","uri":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/"},{"categories":["技术"],"content":"原理步骤： 生成一个oes纹理，并且以此得到一个SurfaceTexture，并设置帧可用回调监听，可用时请求渲染，再得到一个 Surface，并将它回调给外部MediaCodec 配置并启动解码器。（在ESL上下文环境中生成，因此需要通过回调给外部使用） 渲染完一帧后，需调用 surfaceTexture.updateTexImage() //更新纹理数据 onFrameAvailable可用时，请求GLSurfaceView渲染重绘即可 ","date":"2019-07-11","objectID":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/:2:0","tags":["OpenGL ES"],"title":"OpenGL ES：配合MediaCodec硬解码渲染（视频加滤镜播放）","uri":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/"},{"categories":["技术"],"content":"解码器 MediaCodec的准备： 使用MediaExtract选择相应的视频/音频轨道，获取相应的格式信息（MediaFormat）。 使用MdiaCodec的类接口创建codec对象，配置音视频格式以及surface。（ OpenGL回调出来的 Surface surface = new Surface(surfaceTexture);） 启动解码器。 启动一个线程，循环从MediaExtract读取媒体文件数据到MdiaCodec的输入缓冲区，直至文件尾。 从MdiaCodec中取出被成功解码的buffer的 index 和 buffer的信息。index无误则把此buffer渲染到surface上去。 MediaCodec代码如下： package com.example.myapplication.ui.video; import android.media.MediaCodec; import android.media.MediaCodecInfo; import android.media.MediaExtractor; import android.media.MediaFormat; import android.util.Log; import android.view.Surface; import java.io.IOException; import java.nio.ByteBuffer; public class VideoCodec { private static final long TIMEOUT_USEC = 10000; private String TAG = \"VideoCodec\"; private MediaCodec videoDecoder; private MediaExtractor mediaExtractor; private boolean isAvailable = false; //视频路径 private String path; //OpenGL回调出来的 Surface Surface surface = new Surface(surfaceTexture); //surfaceTexture设置帧可用监听 //用于解码后数据的输出，交给OpenGL渲染 private Surface surface; public VideoCodec(String path,Surface surface) { mediaExtractor = new MediaExtractor(); this.path = path; this.surface = surface; } //传入指定的视频或音频格式，例如：video/、audio/ //返回当前格式轨道的index public int getTrackIndex(String mime) { int trackCount = mediaExtractor.getTrackCount(); int videoIndex=-1; for (int i = 0; i \u003c trackCount; i++) { MediaFormat format = mediaExtractor.getTrackFormat(i); if (format.getString(MediaFormat.KEY_MIME).startsWith(mime)) { videoIndex = i; break; } } return videoIndex; } private boolean isPlaying = false; public void start(){ isPlaying = true; DecoderMP4Thread thread = new DecoderMP4Thread(); thread.start(); } //视频的解码放到子线程中进行，防止阻塞主线程 private class DecoderMP4Thread extends Thread { @Override public void run() { try { //首先设置待解码文件的路径 mediaExtractor.setDataSource(path); int videoIndex = getTrackIndex(\"video/\"); //当前index无效则直接退出 if (videoIndex \u003c 0) { return; } //选取当前轨道 mediaExtractor.selectTrack(videoIndex); //获取视频的格式信息 MediaFormat mediaFormat = mediaExtractor.getTrackFormat(videoIndex); //设置解码支持的格式 mediaFormat.setInteger(MediaFormat.KEY_COLOR_FORMAT, MediaCodecInfo.CodecCapabilities.COLOR_FormatRGBFlexible); String mime = mediaFormat.getString(MediaFormat.KEY_MIME); //通过MIME创建解码器 videoDecoder = MediaCodec.createDecoderByType(mime); //配置 videoDecoder.configure(mediaFormat, surface, null, 0); } catch (IOException e) { e.printStackTrace(); } //启动解码器 videoDecoder.start(); int frameIndex = 0; boolean isVideoOver = false; // 开始循环，一直到视频资源结束 MediaCodec.BufferInfo videoBufferInfo = new MediaCodec.BufferInfo(); // 开始的时间 long startMs = System.currentTimeMillis(); // 当前Thread 没有被中断 while (!Thread.interrupted()) { if (!isPlaying) { continue; } if (!isVideoOver) { // 视频没有结束 提取一个单位的视频资源放到 解码器(mediaCodec) 缓冲区中 isVideoOver = putBufferToMediaCodec(mediaExtractor, videoDecoder); } // 返回一个被成功解码的buffer的 index 或者是一个信息 同时更新 videoBufferInfo 的数据 int outputBufferIndex = videoDecoder.dequeueOutputBuffer(videoBufferInfo, TIMEOUT_USEC); switch (outputBufferIndex) { case MediaCodec.INFO_OUTPUT_FORMAT_CHANGED: Log.v(TAG, \"format changed\"); break; case MediaCodec.INFO_TRY_AGAIN_LATER: Log.v(TAG, \"超时\"); break; case MediaCodec.INFO_OUTPUT_BUFFERS_CHANGED: //outputBuffers = videoCodec.getOutputBuffers(); Log.v(TAG, \"output buffers changed\"); break; default: //延时操作 //如果缓冲区里的可展示时间\u003e当前视频播放的总时间，就休眠一下 展示当前的帧， sleepRender(videoBufferInfo, startMs); //渲染为true就会渲染到surface configure() 设置的surface videoDecoder.releaseOutputBuffer(outputBufferIndex, true); frameIndex ++; Log.v(TAG, \"frameIndex \" + frameIndex); break; } if ((videoBufferInfo.flags \u0026 MediaCodec.BUFFER_FLAG_END_OF_STREAM) != 0) { Log.v(TAG, \"buffer stream end\"); break; } } //释放资源 videoDecoder.stop(); videoDecoder.release(); mediaExtractor.release(); } } /** * 将缓冲区传递至解码器 * 如果到了文件末尾，返回true;否则返回false */ private boolean putBufferToMediaCodec(MediaExtractor extractor, MediaCodec decoder) { boolean isMediaEOS = false; // 解码器 要填充有效数据的输入缓冲区的索引 —————— 此id的缓冲区可以被使用 int inputBufferIndex = decoder.dequeueInputBuffer(TIM","date":"2019-07-11","objectID":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/:3:0","tags":["OpenGL ES"],"title":"OpenGL ES：配合MediaCodec硬解码渲染（视频加滤镜播放）","uri":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/"},{"categories":["技术"],"content":"滤镜类（BaseFilter） ","date":"2019-07-11","objectID":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/:4:0","tags":["OpenGL ES"],"title":"OpenGL ES：配合MediaCodec硬解码渲染（视频加滤镜播放）","uri":"/opengl-es%E9%85%8D%E5%90%88mediacodec%E7%A1%AC%E8%A7%A3%E7%A0%81%E6%B8%B2%E6%9F%93%E8%A7%86%E9%A2%91%E5%8A%A0%E6%BB%A4%E9%95%9C%E6%92%AD%E6%94%BE/"}]